---
title: "Rédaction"
output:
  html_document:
    toc: true
    theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

C'est un exemple de rendu de fichier Rmarkdown simple. On pourra travailler la mise en page mais ca donne une idée de à quoi ca peut ressembler 

```{r cars, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
chomage2020 <-read.csv("FD_csv_EEC20.csv",sep = ";")
library(questionr)
library(tidyverse)
library(FactoMineR)

chomage2020=as_tibble(chomage2020)

chomage2020$CSP<-as.character(chomage2020$CSTOTR)
chomage2020$CSP<-fct_recode(chomage2020$CSP,
                            "NR"="0",
                           "Agriculteurs"="1",
                            "Indépendants"="2",
                            "Cadres"="3",
                            "Prof inter"="4",
                            "Employés"="5",
                            "Ouvriers"="6",
                            "Inactifs pro"="7",
                          "Autres inactifs"="8" )

chomage2020$statutACT<-as.character(chomage2020$ACTEU6)
chomage2020$statutACT=fct_explicit_na(chomage2020$statutACT, "null")
chomage2020$statutACT<-fct_recode(chomage2020$statutACT,
                                  "Sans objet" = "null",
                                  "Actif" = "1",
                                  "Chômeur"="3",
                                  "chômeur BIT"="4",
                                  "Étudiant"="5",
                                  "Autres inactifs"="6")


chomage2020$AGE<-as.character(chomage2020$AGE5)
#age au dernier jour de la semaine de référence
chomage2020$AGE<-fct_recode(chomage2020$AGE,
                            #"15 à 29 ans"="0", ## recodage inutile car CSP sans actif 
                            "15 à 29 ans"="15",
                            "30 à 39 ans"="30",
                            "40 à 49 ans"="40",
                            "50 à 59 ans "="50",
                            "60 ans ou +"="60",)


## Actif ou non actif (ACTIF)

chomage2020$tauxdechômage<-as.character(chomage2020$ACTIF)
chomage2020$tauxdechômage<-fct_recode(chomage2020$tauxdechômage,
                                      "Actif au sens du BIT/Actif"="1",
                                      "Actif au sens du BIT/inactif"="2",
)



## raison changement d'emploi (CREACCP)
chomage2020$raisonchangemploi<-as.character(chomage2020$CREACCP)
chomage2020$raisonchangemploi=fct_explicit_na(chomage2020$raisonchangemploi, "null")
chomage2020$raisonchangemploi<-fct_recode(chomage2020$raisonchangemploi,
                                          "Sans objet"="null",
                                          "Perte d'emploi"="1",
                                          "Emploi intéressant"="2",
                                          "Emploi stable (CDI)"="3",
                                          "Plus d'heures"="4",
                                          "Horaires adaptées"="5",
                                          "Conditions favorables"="6",
                                          "Plus de revenus"="7",
                                          "Réduire tmps transport"="8",
                                          "Déménager"="9",
                                          "Travail à son compte"="10",
                                          "Changement métier"="11",
                                          "Mauvaise ambiance"="12",
                                          "Autre raison"="13",
)
#chomage2020=sample_n(chomage2020, 1000)
```

## Graphiques

On peut joindre facilement des graphiques et du texte.
Par exemple là on a un paragraphe. Puis le code qui génére les graphiques. Puis les graphiques eux-mêmes.

```{r pressure}
ggplot(chomage2020)+aes(x=statutACT)+geom_bar(aes(fill=statutACT))

ggplot(chomage2020)+geom_bar(aes(x = CSP, fill=AGE))

ggplot(chomage2020)+geom_bar(aes(x = CSP, fill=AGE), position="fill")


```

Le premier représente la répartition de la population selon le statut d'activité. Le second la répartition de la population selon la CSP et la répartition des ages au sein de chaque CSP. Le troisième uniquement la répartition des ages dans les CSP.


On peut également insérer des graphiques sans le code qui les génére comme suit.
```{r noecho, echo=FALSE}

ggplot(subset(chomage2020, statutACT == "Chômeur")
)+geom_bar(aes(x=AGE, fill=CSP))

ggplot(subset(chomage2020, statutACT == "Actif"))+geom_bar(aes(x=AGE, fill=CSP))
```

Le premier représente l'age et la CSP pour la population des chomeurs PSERE et le second la même chose pour les actifs occupés.
