---
title: "Rédaction"
output:
  html_document:
    toc: true
    theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r cars, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
chomage2020 <-read.csv("FD_csv_EEC20.csv",sep = ";")
library(questionr)
library(tidyverse)
library(FactoMineR)
#chomage2020=sample_n(chomage2020, 1000)
chomage2020=as_tibble(chomage2020)

chomage2020$CSP<-as.character(chomage2020$CSTOTR)
chomage2020$CSP<-fct_recode(chomage2020$CSP,
                            "0"="0",
                            "Indépendants"="2",
                            "Agriculteurs"="1",
                            "Cadres"="3",
                            "Prof inter"="4",
                            "Employés"="5",
                            "Ouvriers"="6",
                            "Inactifs"="7",
                            "Inactifs"="8" )

chomage2020=chomage2020[!is.na(chomage2020$ACTEU6), ]

chomage2020$statutACT<-as.character(chomage2020$ACTEU6)
chomage2020$statutACT<-fct_recode(chomage2020$statutACT,
                                  "Sans objet" = "null",
                                  "Actif occupés" = "1",
                                  "Chômeur"="3",
                                  "Chômeur"="4",
                                  "Étudiant"="5",
                                  "Autres inactifs"="6")


chomage2020$AGE<-as.character(chomage2020$AGE5)
#age au dernier jour de la semaine de référence
chomage2020$AGE<-fct_recode(chomage2020$AGE,
                            #"15 à 29 ans"="0", ## recodage inutile car CSP sans actif 
                            "15 à 29 ans"="15",
                            "30 à 39 ans"="30",
                            "40 à 49 ans"="40",
                            "50 à 59 ans "="50",
                            "60 ans ou +"="60",)


## Actif ou non actif (ACTIF)

chomage2020$tauxdechômage<-as.character(chomage2020$ACTIF)
chomage2020$tauxdechômage<-fct_recode(chomage2020$tauxdechômage,
                                      "Actif au sens du BIT/Actif"="1",
                                      "Actif au sens du BIT/inactif"="2",
)

chomage2020=chomage2020[chomage2020$CSP!="0",]
chomage2020=chomage2020[!is.na(chomage2020$CSP), ]
## raison changement d'emploi (CREACCP)
chomage2020$raisonchangemploi<-as.character(chomage2020$CREACCP)
chomage2020$raisonchangemploi=fct_explicit_na(chomage2020$raisonchangemploi, "null")
chomage2020$raisonchangemploi<-fct_recode(chomage2020$raisonchangemploi,
#                                          "Sans objet"="null",
                                          "Perte d'emploi"="1",
                                          "Emploi intéressant"="2",
                                          "Emploi stable (CDI)"="3",
                                          "Plus d'heures"="4",
                                          "Horaires adaptées"="5",
                                          "Conditions favorables"="6",
                                          "Plus de revenus"="7",
                                          "Réduire tmps transport"="8",
                                          "Déménager"="9",
                                          "Travail à son compte"="10",
                                          "Changement métier"="11",
                                          "Mauvaise ambiance"="12",
                                          "Autre raison"="13",
)
chomage2020$diplome=as.character(chomage2020$DIP11)
chomage2020$diplome=fct_recode(chomage2020$diplome,
           "Licence et +"="10",  
           "Licence et +"="11",
           "Bac +2"="30",
           "Bac +2"="31",
           "Bac +2"="33",
           "Baccalauréat "="41",
           "Baccalauréat "="42",
           "CAP/BEP"="50",
           "Brevet"="60",
           "Certificat d'ét."="70",
           "Aucun"="71"
    )

chomage2020$SEXE=as.character(chomage2020$SEXE)
chomage2020$SEXE=fct_recode(chomage2020$SEXE,
                            "Masculin"="1",
                            "Feminin"="2"
                            
                            )
chomage2020$Htravaillées=chomage2020$HHCE
chomage2020$Hsouhaitées=chomage2020$HPLUSA


```


## Général

```{r général}
#histogrammes des csp

#1
ggplot(chomage2020)+geom_bar(aes(x = CSP))

#2
ggplot(chomage2020)+geom_bar(aes(x = CSP, fill=AGE))

#3
ggplot(chomage2020)+geom_bar(aes(x = CSP, fill=statutACT))

#4
ggplot(chomage2020)+geom_bar(aes(x = CSP, fill=AGE), position="fill")

#5
ggplot(chomage2020)+geom_bar(aes(x = CSP, fill=statutACT), position="fill")

#6
ggplot(chomage2020)+geom_boxplot(aes(x=CSP, y=Htravaillées))+ylim(0, 80)

#7
ggplot(chomage2020)+geom_boxplot(aes(x=CSP, y=Hsouhaitées))+ylim(0, 80)

##histogrammes des ages

#8
ggplot(chomage2020)+geom_bar(aes(x = AGE))

#9
ggplot(chomage2020)+geom_bar(aes(x = AGE, fill=CSP))

#10
ggplot(chomage2020)+geom_bar(aes(x = AGE, fill=statutACT))

#11
ggplot(chomage2020)+geom_bar(aes(x = AGE, fill=CSP), position="fill")

#12
ggplot(chomage2020)+geom_bar(aes(x = AGE, fill=statutACT), position="fill")

#13
ggplot(chomage2020)+geom_boxplot(aes(x=AGE, y=Htravaillées))+ylim(0, 80)

#14
ggplot(chomage2020)+geom_boxplot(aes(x=AGE, y=Hsouhaitées))+ylim(0, 80)

#15
ggplot(chomage2020)+geom_bar(aes(x = statutACT))

#16
ggplot(chomage2020)+geom_bar(aes(x = statutACT, fill=CSP))

#17
ggplot(chomage2020)+geom_bar(aes(x = statutACT, fill=AGE))

#18
ggplot(chomage2020)+geom_bar(aes(x = statutACT, fill=CSP), position="fill")

#19
ggplot(chomage2020)+geom_bar(aes(x = statutACT, fill=AGE), position="fill")

#20
ggplot(chomage2020)+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)


##chomeur vs actif occupés

#21
ggplot(chomage2020[chomage2020$statutACT=="Actif occupés" | chomage2020$statutACT=="Chômeur",])+geom_bar(aes(x = CSP, fill=statutACT), position = "fill")

#22
ggplot(chomage2020[chomage2020$statutACT=="Actif occupés" | chomage2020$statutACT=="Chômeur",])+geom_bar(aes(x = AGE, fill=statutACT), position = "fill")


```

## Niveaux  de diplome

```{r Diplome}
##histogramme des diplomes

#23
ggplot(subset(chomage2020, diplome!="NA"))+geom_bar(aes(x = diplome))

#24
ggplot(subset(chomage2020, diplome!="NA"))+geom_bar(aes(x = diplome, fill=CSP))

#25
ggplot(subset(chomage2020, diplome!="NA"))+geom_bar(aes(x = diplome, fill=AGE))

#26
ggplot(subset(chomage2020, diplome!="NA"))+geom_bar(aes(x = diplome, fill=statutACT))

#27
ggplot(subset(chomage2020, diplome!="NA"))+geom_bar(aes(x = diplome, fill=CSP), position="fill")

#28
ggplot(subset(chomage2020, diplome!="NA"))+geom_bar(aes(x = diplome, fill=AGE), position="fill")

#29
ggplot(subset(chomage2020, diplome!="NA"))+geom_bar(aes(x = diplome, fill=statutACT), position="fill")

#Densité et boites à moustaches pour heures souhaitées et heures travaillées pour chaque niv de diplome

#30
ggplot(subset(chomage2020, diplome!="NA"))+geom_boxplot(aes(x=diplome, y=Htravaillées))+ylim(0, 80)

#31
ggplot(subset(chomage2020, diplome!="NA"))+geom_boxplot(aes(x=diplome, y=Hsouhaitées))+ylim(0, 80)


#32
ggplot(subset(chomage2020, diplome=="Licence et +"))+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#33
ggplot(subset(chomage2020, diplome=="Bac +2"))+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#on a pas de données pour baccalauréat
#ggplot(subset(chomage2020, diplome=="Baccalauréat"))+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#34
ggplot(subset(chomage2020, diplome=="CAP/BEP"))+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#35
ggplot(subset(chomage2020, diplome=="Brevet"))+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#36
ggplot(subset(chomage2020, diplome=="Certificat d'ét."))+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#37
ggplot(subset(chomage2020, diplome=="Aucun"))+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

ggplot(subset(chomage2020, statutACT=="Chômeur" | statutACT=="Actif occupés"))+geom_bar(aes(x=diplome, fill=statutACT))

ggplot(subset(chomage2020, statutACT=="Chômeur" | statutACT=="Actif occupés"))+geom_bar(aes(x=diplome, fill=statutACT), position="fill")

ggplot(subset(chomage2020, statutACT=="Chômeur" | statutACT=="Actif occupés"))+geom_bar(aes(x=diplome, fill=statutACT), position=position_dodge())

ggplot(subset(chomage2020, statutACT=="Chômeur" | statutACT=="Actif occupés", diplome!="NA"))+geom_bar(aes(x=diplome, color=statutACT, fill=AGE), position=position_dodge())

ggplot(subset(chomage2020, statutACT=="Chômeur"))+geom_bar(aes(x=diplome, fill=statutACT))
```

## Sexe

```{r Sexe}
##histogramme des sexes

#38
ggplot(chomage2020)+geom_bar(aes(x = SEXE))

#39
ggplot(chomage2020)+geom_bar(aes(x = SEXE, fill=AGE))

#40
ggplot(chomage2020)+geom_bar(aes(x = SEXE, fill=statutACT))

#41
ggplot(chomage2020)+geom_bar(aes(x = SEXE, fill=AGE), position="fill")

#42
ggplot(chomage2020)+geom_bar(aes(x = SEXE, fill=statutACT), position="fill")

##boites à moustaches et densité pour heures travaillées et heures souhaitées travaillées

#43
ggplot(chomage2020)+geom_boxplot(aes(x=SEXE, y=Htravaillées))+ylim(0, 80)

#44
ggplot(chomage2020)+geom_boxplot(aes(x=SEXE, y=Hsouhaitées))+ylim(0, 80)

#45
ggplot(chomage2020[chomage2020$SEXE=="Feminin",])+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#46
ggplot(chomage2020[chomage2020$SEXE=="Masculin",])+geom_density(aes(Hsouhaitées, color="nb d'heures souhaitées"),bw=3)+geom_density(aes(Htravaillées, color="nb d'heures travaillées"),bw=3)+xlim(0, 80)

#47
ggplot(chomage2020)+geom_density(aes(Htravaillées, color=SEXE),bw=3)+xlim(0, 80)

ggplot(chomage2020)+geom_density(aes(Hsouhaitées, color=SEXE),bw=3)+xlim(0, 80)
```
